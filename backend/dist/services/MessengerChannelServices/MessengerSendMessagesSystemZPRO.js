'use strict';
const _0x33191d = _0x1d2e;
function _0x1d2e(_0x259c6e, _0xc2c21a) {
    const _0xa58563 = _0x3325();
    return _0x1d2e = function (_0x45a39a, _0x10142d) {
        _0x45a39a = _0x45a39a - (-0x3 * 0x577 + -0x1c7b + 0x2 * 0x170f);
        let _0x583177 = _0xa58563[_0x45a39a];
        return _0x583177;
    }, _0x1d2e(_0x259c6e, _0xc2c21a);
}
(function (_0x1b0d2c, _0x9b0e57) {
    const _0x38b31c = _0x1d2e, _0x4d9595 = _0x1b0d2c();
    while (!![]) {
        try {
            const _0x2573f = -parseInt(_0x38b31c(0x189)) / (-0x1 * -0x15b7 + 0x230a + 0xe30 * -0x4) + parseInt(_0x38b31c(0x159)) / (0x3b * 0x5d + 0x4 * -0x47b + -0x27 * 0x17) + -parseInt(_0x38b31c(0x196)) / (-0xa9a * -0x1 + -0x447 + -0x650) + parseInt(_0x38b31c(0x1c0)) / (-0x1703 + -0x3a6 * -0x2 + 0xfbb) + parseInt(_0x38b31c(0x1b1)) / (-0x141d + 0x24f + -0x1b * -0xa9) + parseInt(_0x38b31c(0x1a5)) / (-0x22ca + -0x4f * -0x55 + -0x1 * -0x895) + -parseInt(_0x38b31c(0x13f)) / (-0x2 * -0x12d5 + -0x1 * 0x908 + 0x989 * -0x3);
            if (_0x2573f === _0x9b0e57)
                break;
            else
                _0x4d9595['push'](_0x4d9595['shift']());
        } catch (_0x2d1edb) {
            _0x4d9595['push'](_0x4d9595['shift']());
        }
    }
}(_0x3325, -0xa1b8 + -0x1 * 0x54923 + 0x96a75));
var __awaiter = this && this[_0x33191d(0x14b)] || function (_0x2778a9, _0x443fe8, _0x5a0aa9, _0x5cfed2) {
        const _0x25b5f3 = _0x33191d, _0x227783 = {
                'QPvmT': function (_0xb0017a, _0x3336ad) {
                    return _0xb0017a(_0x3336ad);
                },
                'mORrh': function (_0x3ca9c5, _0x535265) {
                    return _0x3ca9c5 instanceof _0x535265;
                },
                'tJoKy': function (_0x2e69d2, _0x5ed054) {
                    return _0x2e69d2(_0x5ed054);
                },
                'cUjAv': _0x25b5f3(0x1c2),
                'ZYnmj': function (_0x459df4, _0x312cbc) {
                    return _0x459df4(_0x312cbc);
                }
            };
        function _0x57806c(_0x50e47b) {
            const _0x54a6c6 = _0x25b5f3, _0x2f5305 = {
                    'edeAN': function (_0x1d2881, _0x3ed05b) {
                        const _0x5c4120 = _0x1d2e;
                        return _0x227783[_0x5c4120(0x17f)](_0x1d2881, _0x3ed05b);
                    }
                };
            return _0x227783[_0x54a6c6(0x182)](_0x50e47b, _0x5a0aa9) ? _0x50e47b : new _0x5a0aa9(function (_0x344566) {
                const _0x17839e = _0x54a6c6;
                _0x2f5305[_0x17839e(0x176)](_0x344566, _0x50e47b);
            });
        }
        return new (_0x5a0aa9 || (_0x5a0aa9 = Promise))(function (_0x500423, _0x1253b0) {
            const _0x5098ca = _0x25b5f3, _0x4cc835 = {
                    'TJdRs': function (_0x4738e9, _0x302453) {
                        const _0x624ad4 = _0x1d2e;
                        return _0x227783[_0x624ad4(0x19c)](_0x4738e9, _0x302453);
                    },
                    'LIUsw': function (_0x2cac24, _0x57d6bd) {
                        const _0x192657 = _0x1d2e;
                        return _0x227783[_0x192657(0x19c)](_0x2cac24, _0x57d6bd);
                    },
                    'eLRfq': _0x227783[_0x5098ca(0x157)],
                    'oMsGx': function (_0x209405, _0x47ad59) {
                        const _0x5bc26c = _0x5098ca;
                        return _0x227783[_0x5bc26c(0x17f)](_0x209405, _0x47ad59);
                    }
                };
            function _0x269899(_0x20b7ad) {
                const _0x5e48ef = _0x5098ca;
                try {
                    _0x4cc835[_0x5e48ef(0x1b7)](_0x5648de, _0x5cfed2[_0x5e48ef(0x158)](_0x20b7ad));
                } catch (_0x1a1a54) {
                    _0x4cc835[_0x5e48ef(0x1b5)](_0x1253b0, _0x1a1a54);
                }
            }
            function _0x4b5149(_0xe48ce2) {
                const _0x4fa6d0 = _0x5098ca;
                try {
                    _0x4cc835[_0x4fa6d0(0x1b5)](_0x5648de, _0x5cfed2[_0x4cc835[_0x4fa6d0(0x154)]](_0xe48ce2));
                } catch (_0x3d8edf) {
                    _0x4cc835[_0x4fa6d0(0x184)](_0x1253b0, _0x3d8edf);
                }
            }
            function _0x5648de(_0xe0b44c) {
                const _0x114c3d = _0x5098ca;
                _0xe0b44c[_0x114c3d(0x1b3)] ? _0x227783[_0x114c3d(0x19c)](_0x500423, _0xe0b44c[_0x114c3d(0x14f)]) : _0x227783[_0x114c3d(0x17f)](_0x57806c, _0xe0b44c[_0x114c3d(0x14f)])[_0x114c3d(0x1bc)](_0x269899, _0x4b5149);
            }
            _0x227783[_0x5098ca(0x197)](_0x5648de, (_0x5cfed2 = _0x5cfed2[_0x5098ca(0x183)](_0x2778a9, _0x443fe8 || []))[_0x5098ca(0x158)]());
        });
    }, __importDefault = this && this[_0x33191d(0x1c3) + _0x33191d(0x192)] || function (_0x599e4f) {
        const _0x5db28c = _0x33191d;
        return _0x599e4f && _0x599e4f[_0x5db28c(0x1ad)] ? _0x599e4f : { 'default': _0x599e4f };
    };
function _0x3325() {
    const _0x3c5c7e = [
        'ZPRO',
        ':\x20Error\x20se',
        'sleepRando',
        'YmIHr',
        'chat:ack',
        'jqpVV',
        'sendVideo',
        'chat',
        'sendAudio',
        'Error\x20mess',
        'document',
        'erty',
        'fs/promise',
        'domTimeZPR',
        ':::\x20Z-PRO\x20',
        'lvHSc',
        ':::\x20ZDG\x20::',
        'video',
        'edeAN',
        'nant:\x20',
        'sended',
        'EmitZPRO',
        '\x20(id:\x20',
        'logger',
        'mp4',
        'includes',
        'saveToFile',
        'QPvmT',
        'yHULk',
        'defineProp',
        'mORrh',
        'apply',
        'oMsGx',
        'AvJgz',
        'createdAt',
        'sAsReadZPR',
        's/loggerZP',
        '367262IKsVCC',
        'pending',
        'hYAqp',
        'ptt',
        'nd\x20message',
        'ZEkce',
        'mIhwD',
        'rOEzA',
        'sendText',
        'fault',
        'join',
        'peg',
        'ls/TicketZ',
        '1191186pPpsZD',
        'ZYnmj',
        'ecaPo',
        'toBuffer',
        'uBvek',
        'KkVhh',
        'tJoKy',
        'messenger',
        'dataValues',
        'mediaType',
        'PRO',
        'mTime',
        ')::\x20',
        'default',
        'tenantId',
        '913908oskIrn',
        '../../help',
        'KOEiK',
        'ASC',
        'assign',
        'nCMdK',
        'lte',
        'ticket',
        '__esModule',
        'tHOLh',
        'file',
        'ers/SetTic',
        '2170355eEczUO',
        's/sleepRan',
        'done',
        'zXMyW',
        'LIUsw',
        'messengerI',
        'TJdRs',
        'ketMessage',
        'closed',
        'error',
        'split',
        'then',
        '\x20|\x20Ticket:',
        'update',
        'public',
        '270740SUcmAt',
        'ls/Message',
        'throw',
        '__importDe',
        'mediaName',
        'warn',
        'audio',
        'nXnSo',
        'age\x20is\x20(te',
        'KuSVH',
        'sendImage',
        'sharp',
        'toFormat',
        '140861rCmDUi',
        '.mp4',
        'XQGiw',
        'filename',
        'fluent-ffm',
        'timestamp',
        'image',
        'messageId',
        'path',
        'sendFile',
        'YbptK',
        'readFile',
        '__awaiter',
        'text',
        'quotedMsg',
        'bmqwe',
        'value',
        'end',
        'sequelize',
        'contact',
        'body',
        'eLRfq',
        '../../util',
        'jpeg',
        'cUjAv',
        'next',
        '719294IitIpf',
        'BfSqu',
        '../../mode',
        'eaXQh',
        'ywRql',
        'where',
        'findAll',
        'mediaUrl',
        'pxmEe',
        'applicatio',
        'ers/socket'
    ];
    _0x3325 = function () {
        return _0x3c5c7e;
    };
    return _0x3325();
}
const _0x31c80e = {};
_0x31c80e[_0x33191d(0x14f)] = !![], Object[_0x33191d(0x181) + _0x33191d(0x16f)](exports, _0x33191d(0x1ad), _0x31c80e);
const promises_1 = require(_0x33191d(0x170) + 's'), fluent_ffmpeg_1 = __importDefault(require(_0x33191d(0x143) + _0x33191d(0x194))), path_1 = require(_0x33191d(0x147)), sequelize_1 = require(_0x33191d(0x151)), sharp_1 = __importDefault(require(_0x33191d(0x1cb))), SetTicketMessagesAsReadZPRO_1 = __importDefault(require(_0x33191d(0x1a6) + _0x33191d(0x1b0) + _0x33191d(0x1b8) + _0x33191d(0x187) + 'O')), socketEmitZPRO_1 = __importDefault(require(_0x33191d(0x1a6) + _0x33191d(0x163) + _0x33191d(0x179))), MessageZPRO_1 = __importDefault(require(_0x33191d(0x15b) + _0x33191d(0x1c1) + _0x33191d(0x164))), TicketZPRO_1 = __importDefault(require(_0x33191d(0x15b) + _0x33191d(0x195) + _0x33191d(0x1a0))), loggerZPRO_1 = require(_0x33191d(0x155) + _0x33191d(0x188) + 'RO'), sleepRandomTimeZPRO_1 = require(_0x33191d(0x155) + _0x33191d(0x1b2) + _0x33191d(0x171) + 'O'), MessengerSendMessagesSystem = (_0x114d10, _0x4c4542) => __awaiter(void (-0x1a9f + -0x3 * 0x6dc + 0x2f33), void (0x25fc + 0x16f1 * -0x1 + -0xf0b * 0x1), void (-0x1471 * -0x1 + -0x1 * -0x1189 + -0x12fd * 0x2), function* () {
        const _0x16081d = _0x33191d, _0x4e0c2d = {
                'YbptK': _0x16081d(0x17c),
                'zXMyW': _0x16081d(0x1ba),
                'nXnSo': _0x16081d(0x150),
                'nCMdK': _0x16081d(0x18a),
                'tHOLh': _0x16081d(0x152),
                'lvHSc': _0x16081d(0x1ac),
                'AvJgz': _0x16081d(0x1b9),
                'hYAqp': _0x16081d(0x19d),
                'KuSVH': _0x16081d(0x14d),
                'eaXQh': _0x16081d(0x186),
                'mIhwD': _0x16081d(0x1a8),
                'rOEzA': _0x16081d(0x16b),
                'KOEiK': _0x16081d(0x14c),
                'ywRql': _0x16081d(0x1bf),
                'pxmEe': function (_0x3ed603, _0x15458e) {
                    return _0x3ed603 === _0x15458e;
                },
                'bmqwe': _0x16081d(0x1c6),
                'YmIHr': _0x16081d(0x18c),
                'XQGiw': _0x16081d(0x145),
                'ZEkce': _0x16081d(0x175),
                'uBvek': _0x16081d(0x162) + 'n',
                'yHULk': _0x16081d(0x1af),
                'KkVhh': _0x16081d(0x16e),
                'jqpVV': _0x16081d(0x178),
                'BfSqu': _0x16081d(0x168),
                'ecaPo': function (_0x4494a8, _0x46d784) {
                    return _0x4494a8(_0x46d784);
                }
            }, _0x56915d = { [sequelize_1['Op']['is']]: null }, _0x5dd75f = {
                'fromMe': !![],
                'messageId': _0x56915d,
                'status': _0x4e0c2d[_0x16081d(0x1aa)],
                [sequelize_1['Op']['or']]: [
                    { 'scheduleDate': { [sequelize_1['Op'][_0x16081d(0x1ab)]]: new Date() } },
                    { 'scheduleDate': { [sequelize_1['Op']['is']]: null } }
                ]
            }, _0x34a56e = yield MessageZPRO_1[_0x16081d(0x1a3)][_0x16081d(0x15f)]({
                'where': _0x5dd75f,
                'include': [
                    _0x4e0c2d[_0x16081d(0x1ae)],
                    {
                        'model': TicketZPRO_1[_0x16081d(0x1a3)],
                        'as': _0x4e0c2d[_0x16081d(0x173)],
                        'where': {
                            'tenantId': _0x4c4542,
                            [sequelize_1['Op']['or']]: {
                                'status': { [sequelize_1['Op']['ne']]: _0x4e0c2d[_0x16081d(0x185)] },
                                'isFarewellMessage': !![]
                            },
                            'channel': _0x4e0c2d[_0x16081d(0x18b)],
                            'whatsappId': _0x114d10['id']
                        },
                        'include': [_0x4e0c2d[_0x16081d(0x1ae)]]
                    },
                    {
                        'model': MessageZPRO_1[_0x16081d(0x1a3)],
                        'as': _0x4e0c2d[_0x16081d(0x1c9)],
                        'include': [_0x4e0c2d[_0x16081d(0x1ae)]]
                    }
                ],
                'order': [[
                        _0x4e0c2d[_0x16081d(0x15c)],
                        _0x4e0c2d[_0x16081d(0x18f)]
                    ]]
            });
        let _0x374858;
        for (const _0x2de500 of _0x34a56e) {
            const _0x441546 = _0x2de500, {ticket: _0x5d61ec} = _0x441546, _0x3b59a7 = _0x5d61ec[_0x16081d(0x152)][_0x16081d(0x1b6) + 'd'];
            try {
                if (![
                        _0x4e0c2d[_0x16081d(0x190)],
                        _0x4e0c2d[_0x16081d(0x1a7)]
                    ][_0x16081d(0x17d)](_0x441546[_0x16081d(0x19f)]) && _0x441546[_0x16081d(0x1c4)]) {
                    const _0x4885a7 = (0x24d3 + -0x913 + -0x4a * 0x60, path_1[_0x16081d(0x193)])(__dirname, '..', '..', '..', _0x4e0c2d[_0x16081d(0x15d)]), _0x37ff01 = (0x1 * -0x4cf + 0x278 * 0xc + -0x18d1, path_1[_0x16081d(0x193)])(_0x4885a7, _0x441546[_0x16081d(0x1c4)]), _0x1898a1 = yield (-0xe93 + -0x50 * -0x2c + -0xd3 * -0x1, promises_1[_0x16081d(0x14a)])(_0x37ff01);
                    if (_0x4e0c2d[_0x16081d(0x161)](_0x441546[_0x16081d(0x19f)], _0x4e0c2d[_0x16081d(0x14e)]) || _0x4e0c2d[_0x16081d(0x161)](_0x441546[_0x16081d(0x19f)], _0x4e0c2d[_0x16081d(0x167)])) {
                        const _0x28d7b3 = _0x441546[_0x16081d(0x1c4)][_0x16081d(0x1bb)]('.'), _0xae287e = (-0x170b + 0xcdc + 0xa2f, path_1[_0x16081d(0x193)])(_0x4885a7, _0x28d7b3[-0x2 * -0xdb7 + 0x9 * 0x1b + -0x1c61] + _0x16081d(0x140));
                        yield new Promise((_0x128f3c, _0x3b6f6b) => {
                            const _0x19c4ef = _0x16081d;
                            (-0xc77 * -0x1 + -0xac * -0x9 + -0x1283, fluent_ffmpeg_1[_0x19c4ef(0x1a3)])(_0x37ff01)[_0x19c4ef(0x13e)](_0x4e0c2d[_0x19c4ef(0x149)])['on'](_0x4e0c2d[_0x19c4ef(0x1b4)], _0x4064b0 => _0x3b6f6b(_0x4064b0))['on'](_0x4e0c2d[_0x19c4ef(0x1c7)], () => _0x128f3c(!![]))[_0x19c4ef(0x17e)](_0xae287e);
                        });
                        const _0xd96420 = yield (0x17d * 0x13 + -0x2 * 0x55 + -0x1b9d, promises_1[_0x16081d(0x14a)])(_0xae287e);
                        _0x374858 = yield _0x114d10[_0x16081d(0x16c)](_0x3b59a7, _0xd96420);
                    }
                    if (_0x4e0c2d[_0x16081d(0x161)](_0x441546[_0x16081d(0x19f)], _0x4e0c2d[_0x16081d(0x141)])) {
                        const _0x52d712 = yield (-0x5 * 0x151 + -0x237a + 0x61 * 0x6f, sharp_1[_0x16081d(0x1a3)])(_0x1898a1)[_0x16081d(0x156)]()[_0x16081d(0x199)](), _0x5d0abf = {};
                        _0x5d0abf[_0x16081d(0x142)] = _0x441546[_0x16081d(0x1c4)], _0x374858 = yield _0x114d10[_0x16081d(0x1ca)](_0x3b59a7, _0x52d712, _0x5d0abf);
                    }
                    if (_0x4e0c2d[_0x16081d(0x161)](_0x441546[_0x16081d(0x19f)], _0x4e0c2d[_0x16081d(0x18e)])) {
                        const _0x588301 = {};
                        _0x588301[_0x16081d(0x142)] = _0x441546[_0x16081d(0x1c4)], _0x374858 = yield _0x114d10[_0x16081d(0x16a)](_0x3b59a7, _0x1898a1, _0x588301);
                    }
                    if ([
                            _0x4e0c2d[_0x16081d(0x19a)],
                            _0x4e0c2d[_0x16081d(0x180)],
                            _0x4e0c2d[_0x16081d(0x19b)]
                        ][_0x16081d(0x17d)](_0x441546[_0x16081d(0x19f)])) {
                        const _0xaf606b = {};
                        _0xaf606b[_0x16081d(0x142)] = _0x441546[_0x16081d(0x1c4)], _0x374858 = yield _0x114d10[_0x16081d(0x148)](_0x3b59a7, _0x1898a1, _0xaf606b);
                    }
                }
                [
                    _0x4e0c2d[_0x16081d(0x190)],
                    _0x4e0c2d[_0x16081d(0x1a7)]
                ][_0x16081d(0x17d)](_0x441546[_0x16081d(0x19f)]) && !_0x441546[_0x16081d(0x1c4)] && (_0x374858 = yield _0x114d10[_0x16081d(0x191)](_0x3b59a7, _0x441546[_0x16081d(0x153)]));
                const _0x1ee145 = Object[_0x16081d(0x1a9)](Object[_0x16081d(0x1a9)](Object[_0x16081d(0x1a9)]({}, _0x441546), _0x374858), {
                        'id': _0x441546['id'],
                        'timestamp': _0x441546[_0x16081d(0x144)],
                        'messageId': _0x374858[_0x16081d(0x146)],
                        'status': _0x4e0c2d[_0x16081d(0x169)],
                        'ack': 0x2
                    }), _0x39689a = {};
                _0x39689a['id'] = _0x441546['id'];
                const _0x544248 = {};
                _0x544248[_0x16081d(0x15e)] = _0x39689a, yield MessageZPRO_1[_0x16081d(0x1a3)][_0x16081d(0x1be)](Object[_0x16081d(0x1a9)]({}, _0x1ee145), _0x544248), (0x18e3 + -0x789 * 0x1 + -0x115a, socketEmitZPRO_1[_0x16081d(0x1a3)])({
                    'tenantId': _0x5d61ec[_0x16081d(0x1a4)],
                    'type': _0x4e0c2d[_0x16081d(0x15a)],
                    'payload': Object[_0x16081d(0x1a9)](Object[_0x16081d(0x1a9)]({}, _0x441546[_0x16081d(0x19e)]), {
                        'mediaUrl': _0x441546[_0x16081d(0x160)],
                        'id': _0x441546['id'],
                        'timestamp': _0x441546[_0x16081d(0x144)],
                        'messageId': _0x374858[_0x16081d(0x146)],
                        'status': _0x4e0c2d[_0x16081d(0x169)],
                        'ack': 0x2
                    })
                }), yield (0x14dc + 0x15cd + -0x2aa9, SetTicketMessagesAsReadZPRO_1[_0x16081d(0x1a3)])(_0x5d61ec), yield (-0x314 + -0x12d9 + 0x1 * 0x15ed, sleepRandomTimeZPRO_1[_0x16081d(0x166) + _0x16081d(0x1a1)])({
                    'minMilliseconds': _0x4e0c2d[_0x16081d(0x198)](Number, 0x1 * -0xf1a + 0x1 * -0x1687 + -0x1 * -0x2795),
                    'maxMilliseconds': _0x4e0c2d[_0x16081d(0x198)](Number, 0x3e * 0x6e + 0x3 * -0x61f + -0x26b)
                });
            } catch (_0x59b60d) {
                const _0x34c547 = _0x441546['id'], _0x53f025 = _0x441546[_0x16081d(0x1ac)]['id'];
                loggerZPRO_1[_0x16081d(0x17b)][_0x16081d(0x1ba)](_0x16081d(0x16d) + _0x16081d(0x1c8) + _0x16081d(0x177) + _0x4c4542 + (_0x16081d(0x1bd) + '\x20') + _0x53f025 + ')'), loggerZPRO_1[_0x16081d(0x17b)][_0x16081d(0x1c5)](_0x16081d(0x172) + _0x16081d(0x174) + _0x16081d(0x165) + _0x16081d(0x18d) + _0x16081d(0x17a) + _0x34c547 + _0x16081d(0x1a2) + _0x59b60d);
            }
        }
    });
exports[_0x33191d(0x1a3)] = MessengerSendMessagesSystem;